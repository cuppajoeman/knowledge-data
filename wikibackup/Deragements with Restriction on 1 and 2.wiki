We will use the principle of inclusion exclusion in combination with the formula for the number of derangement.

* We want to find all derangements <math display="inline">\sigma</math> of <math display="inline">\left[ n \right]</math> such that <math display="inline">\sigma\left( \left\{ 1, 2 \right\} \right) \cap \left\{ 1, 2 \right\}= \emptyset</math>, rather <math display="block">\left\{ \sigma \left( 1 \right), \sigma\left( 2\right) \right\} \cap \left\{ 1, 2 \right\} = \emptyset</math>
* We already know that <math display="inline">\sigma \left( i  \right)\neq i, \forall i \in \left[ n \right]</math> so we just require that that <math display="inline">\sigma\left( 1 \right) \neq 2</math> and <math display="inline">\sigma \left(2\right) \neq 1</math>.
* So the set of properties that we don't want <math display="inline">\sigma</math> to satisfy is <math display="inline">\left\{ \sigma \left( 1 \right) =2, \sigma\left(2\right)=1 \right\}</math>. By the principle of inclusion exclusion, we have a way to compute what we are looking for so long as we know how many derangement have each of those properties individually.
** Suppose that <math display="inline">\sigma\left(1\right)=2</math>, now we can take a derangement on <math display="inline">\left[ n \right] \setminus \left\{ 1 \right\}</math> and then join them together, which is saying that the number of derangmenets where <math display="inline">1 \mapsto 2</math> is exactly the number of derangements on <math display="inline">\left[ n-1 \right]</math> which there are <math display="block">d_{n-1} = \sum_{k=0}^{n-1} \left( -1 \right)^{k}\binom{n-1}{k}\left( n - k \right)!</math>
* In this way we can see that the number of derangements that we originally set out to find is exactly <math display="block">\sum_{S \subseteq \left[ 2 \right]} \left( -1 \right) ^{\left| S \right|} N\left(S\right)</math> Where <math display="inline">N\left(\left\{ 1 \right\}\right) = d_{n-1}</math> , <math display="inline">N\left(\left\{ 2 \right\}\right) = d_{n-1}</math> and <math display="inline">N\left(\left\{ 1, 2 \right\}\right)= d_{n-2 }</math>. Not forgetting that <math display="inline">N\left(\emptyset\right)</math> is just the total number of derangement; that is <math display="inline">d_{n}</math>